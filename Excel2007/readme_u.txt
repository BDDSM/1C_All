
Чтение/запись документ Excel 2007 без установленного Excel'а, без внешних компонент, исключительно средствами 1С.

Написано в ознакомительных целях, по аналогии с http://infostart.ru/projects/2365/

//*******************************************
Процедура ОткрытьФайлЭкзекль2007(ПутьКФайлу)
  Экзель = Обработки.Excel2007.Создать();
  
  Если НЕ Экзель.ОткрытьФайл(ПутьКФайлу) Тогда
    Предупреждение("Файл " + ПутьКФайлу + " не открыт!");
  КонецЕсли;
  
  Если НЕ Экзель.ОткрытьЛист(1) Тогда
    Предупреждение("Лист 1 не открыт!");
  КонецЕсли;
  
  Сообщить("Количество строк: " + Экзель.Лист.Количество());
  Сообщить("Количество колонок: " + Экзель.Лист.Колонки.Количество());
КонецПроцедуры
//*******************************************
Процедура СоздатьФайлЭкзель2007(ПутьКФайлу)
  //заполняем ТЗ
  ТЗ = Новый ТаблицаЗначений;
  ТЗ.Колонки.Добавить("К1");
  ТЗ.Колонки.Добавить("К2");
  
  Стр = ТЗ.Добавить();
  Стр.К1 = "Номенклатура";
  Стр.К2 = "Количество";
  
  Стр = ТЗ.Добавить();
  Стр.К1 = "Хлеб";
  Стр.К2 = 10;
  
  Стр = ТЗ.Добавить();
  Стр.К1 = "Мясо";
  Стр.К2 = 14;
  
  //сохраняем тз в экзель
  Экзель = Обработки.Excel2007.Создать();
  Экзель.Лист = ТЗ;
  Экзель.Записать(ПутьКФайлу);
  
  ЗапуститьПриложение(ПутьКФайлу);
КонецПроцедуры
//*******************************************


(с) Vasil aka Душелов
icq: 48715748
http://www.dushelov.ru